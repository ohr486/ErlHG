## 事前準備

本章はmac/homebrewの環境を前提としています。
申し訳ありませんが、Windowsな人はGoogle先生に聞いてください。

### ソースコード

Erlangのソースコードは[こちら](https://github.com/erlang/otp)から`git clone`できます。

### ブランチ

Erlangのブランチは大きく以下のカテゴリに分類されます。

* master
* maint
* maint-xxx

これらのブランチの用途は以下の通りです。

#### masterブランチ

次のメジャーリリース(OTP-XX.0)のリリースに利用されます。
このブランチには次のメジャーリリースに含まれる全ての機能が含まれます。
新しい機能を追加したい場合はこのブランチをチェックするのがよいでしょう。

#### maintブランチ

次にくるマイナーリリース(OTP-XX.Y)のリリースに利用されます。
このブランチには新機能は含まれず、バグ修正と改善のみです。
バグや改善に関する変更を追加したい倍はこのブランチをチェックするのがよいでしょう。

#### maint-xxxブランチ

パッチリリース(OTP-XX.Y.Z)を追跡する為に利用されます。
重要な壊れた挙動の修正が決定されたパッチがこのブランチに含まれます。
重要なパッチについて追跡したい場合はこのブランチをチェックするのがよいでしょう。

本ドキュメントでは、masterブランチをターゲットにして進めていきます。

### ビルドに必要なツール/ライブラリのインストール

Erlangのビルドに必要なツール/ライブラリは以下です。

* make
* jdk
* perl
* odbc(macの場合はunixodbc)

Erlangのビルドをする前に、これらのツールをインストールしておきましょう。

### ビルド高速化の為の環境変数

Erlangのビルドは時間がかかるので、ビルド高速化の為に以下の環境変数を設定しておきましょう。

#### 環境変数 MAKEFLAGS

ビルド時の`configure`と`make`は、環境変数`MAKEFLAGS`を設定して並列化する事ができます。
並列数はビルドを行うマシンのコア数に合わせて設定しましょう。

例えば、4コアのマシンでビルドする場合には、以下の様に設定します。

```bash
export MAKEFLAGS="-j4"
```

#### 環境変数 ERLC_USE_SERVER

Erlangの標準ライブラリやOTPはErlangのプログラムで実装されている為、ビルドの際にはErlangのコンパイルが走ります。
ErlangのコンパイラもErlangのプログラムなので、コンパイルが実行される度にErlangのシステムが起動されます。
この時、[コンパイルサーバー](https://www.erlang.org/doc/man/erlc.html#compile-server)を利用する事で、コンパイル対象のファイルごとにErlangのシステムを起動する必要がなくなるので、ビルド時間が短縮できます。

コンパイルサーバーを有効にするには、以下の様に設定します。

```bash
export ERLC_USE_SERVER=true
```

### ドキュメントを読むためのツール

* plantUML

本ドキュメントに出てきる図はplantUMLを利用して作図されます。
ドキュメントを読む際には、plantUMLを読み込むためのツールをインストールしておいてください。
